# Safety Stock 計算器 - 完整使用指南

## 目錄

1. [簡介](#簡介)
2. [安裝](#安裝)
3. [基本使用](#基本使用)
4. [進階功能](#進階功能)
5. [常見問題](#常見問題)
6. [技術詳情](#技術詳情)

---

## 簡介

Safety Stock 計算器是一個現代化的網頁應用，幫助你輕鬆管理和計算多間店鋪的安全庫存。

**主要特點：**
- 🖥️ 現代化的網頁界面
- 📊 精確的Safety Stock計算
- 🏪 支持無限數量的店鋪
- ⚙️ 靈活的參數配置
- 💾 本地存儲和數據導出
- 🌐 完全離線運行

---

## 安裝

### 系統需求
- 任何現代網頁瀏覽器（Chrome、Firefox、Safari、Edge）
- 無需安裝任何額外軟件

### 獲取文件

#### 方法1：直接打開
```bash
# Windows
在檔案管理器中找到 index.html，雙擊打開

# macOS / Linux
在終端中運行：
open index.html
```

#### 方法2：使用本地伺服器
```bash
# 使用 Python
cd /path/to/calculator
python -m http.server 8000

# 使用 Node.js
cd /path/to/calculator
npx http-server

# 在瀏覽器中訪問
http://localhost:8000
```

---

## 基本使用

### 第一步：選擇店鋪

#### 方法1：手動選擇
1. 在「選擇店鋪」區域勾選你需要的店鋪
2. 可以逐個選擇，也可以使用快捷功能

#### 方法2：使用快捷按鈕
- **全選**：選擇所有店鋪
- **反選**：取消所有選擇
- **反向取消**：反轉當前選擇

#### 方法3：使用分類篩選

**按大小分類：**
- XS：超小型店鋪（面積 <100㎡）
- S：小型店鋪（面積 100-200㎡）
- M：中型店鋪（面積 200-500㎡）
- L：大型店鋪（面積 >500㎡）

**按等級分類：**
- A：優先級最高（核心店鋪、高銷售量）
- B：優先級較高
- C：優先級中等
- D：優先級最低

**使用方式：**
1. 點擊「按大小分類」或「按等級分類」中的按鈕
2. 系統會自動顯示符合條件的店鋪
3. 可以多選多個分類

### 第二步：調整參數

每個 Safety Stock 參數都可以根據你的業務情況調整：

#### 核心參數

| 參數 | 單位 | 預設值 | 說明 | 影響 |
|------|------|--------|------|------|
| **前置時間** | 天 | 14 | 供應商交貨需要的天數 | 值越大，庫存越多 |
| **需求變異系數** | - | 1.5 | 需求的波動程度 (0-2) | 值越大，庫存越多 |
| **服務水準 (Z值)** | - | 1.65 | 預期庫存充足率 | 值越大，庫存越多 |
| **平均日需求** | 件 | 50 | 每天平均銷售量 | 值越大，庫存越多 |
| **訂貨點** | 件 | 自動 | 觸發訂貨的庫存水位 | 自動計算 |
| **經濟訂單量** | 件 | 100 | 最經濟的訂單數量 | 成本優化 |

#### 如何調整參數

1. 在「調整 Safety Stock 參數」區域找到你要調整的參數
2. 在輸入框中輸入新值
3. 系統會實時保存你的更改
4. 點擊「計算」按鈕應用新參數

**示例場景：**

場景1 - 品牌新品上市（高風險）
```
服務水準：提高到 2.0-2.5（99%充足率）
前置時間：保持不變或增加
需求變異系數：提高到 2.0（需求不穩定）
```

場景2 - 暢銷品穩定銷售
```
服務水準：1.65（95%充足率）
前置時間：14 天
需求變異系數：1.0（需求穩定）
```

場景3 - 季末清倉（低風險）
```
服務水準：降低到 1.0（84%充足率）
前置時間：減少
需求變異系數：降低到 0.5
```

### 第三步：計算結果

1. 確認已選擇至少一間店鋪
2. 確認參數已調整完畢
3. 點擊「計算」按鈕
4. 系統會顯示每間店鋪的 Safety Stock 計算結果

**結果表格包含：**
- **店鋪**：店鋪名稱
- **分類**：店鋪大小和等級（如 M/B）
- **原始庫存**：基礎庫存需求
- **Safety Stock 參數**：使用的計算參數摘要
- **計算庫存**：最終推薦的 Safety Stock

### 第四步：查看和導出結果

#### 查看結果
- 結果自動顯示在表格中
- 可以向下滾動查看所有店鋪

#### 導出結果

**導出 CSV（用於 Excel）**
1. 點擊「匯出 CSV」
2. 文件會自動下載到你的電腦
3. 可以在 Excel 中打開和進一步分析

**導出配置（JSON）**
1. 點擊「匯出配置」
2. 會保存當前選擇的店鋪和參數
3. 下次可以快速導入相同配置

**打印結果**
1. 點擊「打印」
2. 會打開打印預覽窗口
3. 可以打印或另存為 PDF

---

## 進階功能

### 管理店鋪名單

#### 查看現有店鋪
1. 進入「🔧 店鋪名單管理」區域
2. 點擊「編輯店鋪名單」
3. 查看現有的 JSON 格式店鋪列表

#### 新增店鋪

**步驟：**
1. 點擊「編輯店鋪名單」
2. 在 JSON 中新增一行：
```json
{ "name": "你的店名", "size": "M", "level": "A" }
```
3. 注意 JSON 格式要正確（逗號、引號等）
4. 點擊「保存」

**新增多間店鋪：**
```json
[
    { "name": "店鋪A", "size": "L", "level": "A" },
    { "name": "店鋪B", "size": "M", "level": "B" },
    { "name": "店鋪C", "size": "S", "level": "C" },
    { "name": "店鋪D", "size": "XS", "level": "D" }
]
```

#### 修改店鋪資訊
1. 點擊「編輯店鋪名單」
2. 修改對應店鋪的資訊
3. 點擊「保存」

#### 刪除店鋪
1. 點擊「編輯店鋪名單」
2. 刪除對應的整行 JSON
3. 點擊「保存」

### 配置管理

#### 導入之前的配置
1. 點擊「匯入配置」
2. 選擇之前保存的 `.json` 配置文件
3. 系統會自動加載配置
4. 所有店鋪選擇和參數會恢復

#### 保存配置備份
1. 完成計算後，點擊「匯出配置」
2. 定期保存備份
3. 可以用於團隊協作或版本控制

---

## 常見問題

### Q1: 我看不到計算結果？

**可能的原因和解決方案：**

1. **沒有選擇店鋪**
   - 解決：在店鋪選擇區域勾選至少一間店鋪

2. **參數值不正確**
   - 解決：檢查所有參數值是否在有效範圍內

3. **瀏覽器緩存**
   - 解決：按 F5 刷新頁面或使用 Ctrl+F5 強制刷新

### Q2: 為什麼計算結果不同？

**可能的原因：**

1. **參數被修改**
   - 檢查當前參數值是否與上次相同

2. **選擇的店鋪不同**
   - 檢查是否選擇了不同的店鋪組合

3. **公式更新**
   - 檢查 config.js 中的計算公式是否被修改

**解決方案：**
- 導入之前的配置文件
- 檢查結果表格中的「Safety Stock 參數」列

### Q3: 如何處理 JSON 格式錯誤？

**常見 JSON 錯誤：**

1. **遺漏引號**
   ```json
   // ❌ 錯誤
   { name: "店鋪", size: M, level: "A" }
   
   // ✅ 正確
   { "name": "店鋪", "size": "M", "level": "A" }
   ```

2. **遺漏逗號**
   ```json
   // ❌ 錯誤
   [
       { "name": "店鋪A", "size": "M", "level": "A" }
       { "name": "店鋪B", "size": "S", "level": "B" }
   ]
   
   // ✅ 正確
   [
       { "name": "店鋪A", "size": "M", "level": "A" },
       { "name": "店鋪B", "size": "S", "level": "B" }
   ]
   ```

3. **多餘的逗號**
   ```json
   // ❌ 錯誤
   { "name": "店鋪", "size": "M", "level": "A", }
   
   // ✅ 正確
   { "name": "店鋪", "size": "M", "level": "A" }
   ```

**修復方法：**
- 使用 JSON 驗證工具：https://jsonlint.com/
- 仔細檢查引號和逗號
- 從示例複製格式

### Q4: 數據會丟失嗎？

**數據安全性：**

- ✅ 配置自動保存到瀏覽器本地存儲
- ✅ 關閉瀏覽器數據不會丟失
- ✅ 清除瀏覽器緩存會丟失（定期導出備份）
- ✅ 不同瀏覽器數據不同步

**備份建議：**
1. 定期點擊「匯出配置」保存
2. 將配置文件存儲在雲盤或 GitHub
3. 保留多個版本以防意外

### Q5: 能在多台電腦上使用嗎？

**跨設備同步方案：**

1. **手動同步（推薦）**
   - 在一台電腦上導出配置
   - 在另一台電腦上導入配置

2. **雲盤同步**
   - 將整個項目文件夾放在雲盤（Dropbox、OneDrive 等）
   - 在不同電腦上訪問相同路徑

3. **GitHub 同步**
   - 上傳項目到 GitHub
   - 在不同電腦上 clone 項目
   - 配置文件手動同步

### Q6: 如何修改計算公式？

**修改公式的步驟：**

1. 打開 `config.js` 文件
2. 找到 `CALCULATION_FORMULAS` 對象
3. 修改相應公式，例如：

```javascript
// 原始公式
basic: function(params) {
    const z = params.service_level || 1.65;
    const sigma = (params.average_daily_demand || 50) * (params.demand_variability || 1.5);
    const leadTime = Math.sqrt(params.lead_time || 14);
    return Math.ceil(z * sigma * leadTime);
}

// 修改為自定義公式
basic: function(params) {
    // 你的自定義計算邏輯
    return Math.ceil(/* 你的計算 */);
}
```

4. 保存文件並刷新瀏覽器

---

## 技術詳情

### 計算公式

#### 基本 Safety Stock 公式
```
Safety Stock (SS) = Z × σ × √L

其中：
Z = 服務水準系數
σ = 需求標準差 (= 平均日需求 × 需求變異係數)
L = 前置時間 (天)
```

**Z 值對應的服務水準：**
| Z 值 | 服務水準 | 缺貨概率 |
|------|---------|---------|
| 0.84 | 80% | 20% |
| 1.04 | 85% | 15% |
| 1.28 | 90% | 10% |
| 1.65 | 95% | 5% |
| 1.96 | 97.5% | 2.5% |
| 2.33 | 99% | 1% |
| 2.58 | 99.5% | 0.5% |
| 3.09 | 99.9% | 0.1% |

#### 訂貨點（Reorder Point）
```
ROP = (平均日需求 × 前置時間) + Safety Stock
```

#### 經濟訂單量（Economic Order Quantity）
```
EOQ = √[(2 × D × S) / H]

其中：
D = 年需求量
S = 訂單成本
H = 單位年持有成本
```

### 文件結構

```
index.html      主 HTML 頁面
styles.css      完整的 CSS 樣式
config.js       配置文件（包含計算公式）
app.js          主應用邏輯
advanced.js     可選的高級功能
```

### 瀏覽器兼容性

| 瀏覽器 | 版本 | 支持 |
|--------|------|------|
| Chrome | 60+ | ✅ |
| Firefox | 60+ | ✅ |
| Safari | 12+ | ✅ |
| Edge | 79+ | ✅ |
| IE | 11 | ⚠️ 不完全支持 |

### 本地存儲

- 使用瀏覽器 localStorage
- 存儲大小：通常 5-10MB
- 存儲位置：%AppData%\Local\[Browser]\User Data

---

## 進階用例

### 用例1：批量更新所有店鋪的 Safety Stock

1. 選擇「全選」
2. 調整參數（如提高服務水準至 2.0）
3. 點擊「計算」
4. 點擊「匯出 CSV」將結果發送給採購部

### 用例2：按類別計算庫存

1. 選擇「按等級分類」→ 點擊「A」
2. 調整 A 級店鋪的專用參數
3. 計算結果
4. 重複不同等級

### 用例3：季節性調整

1. 導入上一季的配置
2. 調整參數（前置時間、需求等）
3. 計算新的 Safety Stock
4. 與上一季對比

---

## 支持和反饋

如有問題或建議，請：

1. 檢查此文檔
2. 查看 QUICK_START.md
3. 查看代碼註釋
4. 提交 GitHub Issue（如適用）

---

**最後更新：2026年1月31日**

祝你使用愉快！🎉
